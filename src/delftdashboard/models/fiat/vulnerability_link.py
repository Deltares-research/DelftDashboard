# -*- coding: utf-8 -*-
"""
Created on Mon May 10 12:18:09 2021

@author: ormondt
"""

from delftdashboard.app import app
from delftdashboard.operations import map

from hydromt_fiat.api.hydromt_fiat_vm import HydroMtViewModel


def select(*args):
    # De-activate existing layers
    map.update()


def edit(*args):
    app.model["fiat"].set_model_variables()


def activate_create_curves_panel(*args):
    app.gui.setvar("fiat", "create_curves", True)


def set_curve_join_type(*args):
    curve_join_type = app.gui.getvar("fiat", "curve_join_type_value")
    app.gui.setvar("fiat", "curve_join_type", curve_join_type)


def link_vulnerability_curve(*args):
    selected_curve_name = app.gui.getvar("fiat", "selected_vulnerability_curve")
    selected_classification_name = app.gui.getvar(
        "fiat", "selected_secondary_classification_type"
    )

    hydro_vm = HydroMtViewModel(
        app.config["working_directory"], app.config["data_libs_fiat"][0]
    )
    add_curve = hydro_vm.vulnerability_vm.set_linking_table(
        name=selected_curve_name, link=selected_classification_name
    )
    list_curves = app.gui.getvar("fiat", "curve_classification_string")
    list_curves = [add_curve] + list_curves
    app.gui.setvar("fiat", "curve_classification_string", list_curves)
    app.gui.setvar("fiat", "curve_classification_value", add_curve)
